<!DOCTYPE html>

<!--
  portfolYOU Jekyll theme by Youssef Raafat
  Free for personal and commercial use under the MIT license
  https://github.com/YoussefRaafatNasry/portfolYOU
-->

<html lang="en" class="h-100">

<head>

  
  
  

  

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:type" content="website">
  <meta property="og:title" content="Malaysia Covid-19 Analysis and Prediction">
  <meta property="og:description" content="Wonder how's the Covid-19 situation in Malaysia? Is it getting worse or getting better? Let's find out.">
  <meta property="og:image" content="https://www.emeraldgrouppublishing.com/sites/default/files/styles/service_page_banner_desktop/public/image/covid-cells.jpg">

  <title>Malaysia Covid-19 Analysis and Prediction</title>
  <meta name="description" content="Wonder how's the Covid-19 situation in Malaysia? Is it getting worse or getting better? Let's find out.">

  <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico">

  <!-- Theme style -->
  <script src="/assets/js/theme.js"></script>

  <!-- Font Awesome CDN -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.10.0/css/all.css">

  <!-- Bootstrap CSS CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">

  <!-- Animate CSS CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/assets/css/style.css">

</head>

<body class="h-100 d-flex flex-column">

  <main class="flex-shrink-0 container mt-5">
    <nav class="navbar navbar-expand-lg navbar-themed">

  <a class="navbar-brand" href="/"><h5><b>Haziq's Portfolio</b></h5></a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <i class="fas fa-1x fa-bars text-themed"></i>
  </button>

  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <div class="navbar-nav ml-auto"><a class="nav-item nav-link active" href="/projects/">Projects</a>

      <a class="nav-item nav-link " href="/blog/">Blog</a>

      <a class="nav-item nav-link " href="/about/">About</a>

      

      <span id="theme-toggler" class="nav-item nav-link" role="button" onclick="toggleTheme()"></span>
    </div>
  </div>

</nav>
    <div class="col-lg-10 mx-auto mt-5 markdown-body">
  <p><img src="https://assets.weforum.org/article/image/large_Gt3_maI3Pg1p3LCdz686W_z41IEvOy6elJNQmu_oRLc.jpg" alt="jpg" /></p>

<h1 id="1-questions">1. Questions</h1>

<p>This analysis will try to answer the following questions:</p>
<ul>
  <li>What factor that most likely to cause an increases in the number of new cases?</li>
  <li>How Covid-19 affects differently in different states?</li>
  <li>When will we achieve herd immunity?</li>
  <li>Will new cases increases or decrease next month?</li>
</ul>

<h1 id="2-measurement-priorities">2. Measurement Priorities</h1>

<ul>
  <li>Correlation between each factor in the dataset using correlation matrix.</li>
  <li>The difference in the count of new cases and in the states.</li>
  <li>Percentage of fully vaccinated individuals angainst the total population.</li>
  <li>Number of forecasted new cases in the next 30 days using time series forecasting.</li>
</ul>

<h1 id="3-data-collection">3. Data Collection</h1>

<ul>
  <li>Source
    <ul>
      <li>For this analysis, we will make use of the dataset from The Ministry of Health Malaysia GitHub page.</li>
      <li>Since they don’t provide data for vaccinations, we will obtain the data from other sources which in this case is from Our World in Data.</li>
      <li>These sites frequently updates these data values, we will use programmatically automate this data collection process each time we restart the notebook</li>
    </ul>
  </li>
  <li>Storage
    <ul>
      <li>The data collected from the sites will bw stored as a CSV file in the /dataset directory.</li>
      <li>This allows the data can still be analysed localy when connectivity problems persists.</li>
    </ul>
  </li>
</ul>

<h5 id="github-link-for-project"><a href="https://github.com/ameerhaziq20/data-science-portfolio/tree/main/Malaysia_COVID_19_Cases_Analysis_and_Prediction">Github link for project</a></h5>
<hr />
<p><strong>Notebook contents:</strong></p>

<p><a href="#import_data"><strong>Importing the data</strong></a></p>

<p><a href="#eda"><strong>EDA</strong></a></p>
<ol>
  <li><a href="#factor_corr"><strong>Factors that correlates to the number of new cases</strong></a>
    <ul>
      <li><a href="#factor_corr_c">Data cleaning</a></li>
      <li><a href="#corr_var">Correlation between variables</a></li>
      <li><a href="#var_time_data">Dataset variables value over time</a></li>
    </ul>
  </li>
  <li><a href="#herd_immunity"><strong>Vaccination</strong></a>
    <ul>
      <li><a href="#herd_immunity_c">Data cleaning</a></li>
      <li><a href="#vac_prog">Plot of vaccination progress in Malaysia</a></li>
      <li><a href="#full_vac">Percentage of fully vaccinated count against population</a></li>
      <li><a href="#vac_time">Percentage of fully vaccinated count across time</a></li>
    </ul>
  </li>
  <li><a href="#state_case"><strong>Count of new cases by state</strong></a>
    <ul>
      <li><a href="#state_case_c">Data cleaning</a></li>
      <li><a href="#state_case_plot">Plot of new cases for each state over time</a></li>
    </ul>
  </li>
  <li><a href="#test_state"><strong>Count of Covid tests by state</strong></a>
    <ul>
      <li><a href="#test_state_c">Data cleaning</a></li>
      <li><a href="#test_state_plot">Plot of total Covid tests by state</a></li>
    </ul>
  </li>
</ol>

<p><a href="#new_case_proph"><strong>Covid-19 new cases forecast</strong></a></p>
<ul>
  <li><a href="#proph_prep">Data preparation</a></li>
  <li><a href="#hyperparameter">Hyperparameter tuning</a></li>
  <li><a href="#forc_new">Forecast new cases</a></li>
</ul>

<p><a href="#pred_model"><strong>Prediction model</strong></a></p>
<ul>
  <li><a href="#pred_proc">Data preprocessing</a></li>
  <li><a href="#train_eval">Training and evaluation</a></li>
</ul>

<p><a id="import_data"></a></p>
<h1 id="importing-the-data">Importing the data</h1>
<p>Since the data is frequently updated, we will grab the data directly from the site instead of having to download the csv files manually to perform the analysis. The other good part about this is that the analysis done in on the latest data provided.</p>

<p>Datasets are obtained from:</p>

<ul>
  <li><a href="https://github.com/MoH-Malaysia/covid19-public/">Ministry of Health Malaysia Github</a></li>
  <li><a href="https://github.com/owid/covid-19-data/tree/master/public/data/vaccinations">Our World In Data</a></li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">requests</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">url</span><span class="o">=</span><span class="s">"https://raw.githubusercontent.com/MoH-Malaysia/covid19-public/main/epidemic/tests_malaysia.csv"</span>
<span class="n">s</span><span class="o">=</span><span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">).</span><span class="n">content</span>
<span class="n">tests</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)))</span>
<span class="n">tests</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'dataset/tests_malaysia.csv'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">url</span><span class="o">=</span><span class="s">"https://raw.githubusercontent.com/MoH-Malaysia/covid19-public/main/epidemic/cases_malaysia.csv"</span>
<span class="n">s</span><span class="o">=</span><span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">).</span><span class="n">content</span>
<span class="n">cases</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)))</span>
<span class="n">cases</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'dataset/cases_malaysia.csv'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">url</span><span class="o">=</span><span class="s">"https://raw.githubusercontent.com/MoH-Malaysia/covid19-public/main/epidemic/cases_state.csv"</span>
<span class="n">s</span><span class="o">=</span><span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">).</span><span class="n">content</span>
<span class="n">state_cases</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)))</span>
<span class="n">state_cases</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'dataset/cases_state.csv'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">url</span><span class="o">=</span><span class="s">"https://raw.githubusercontent.com/MoH-Malaysia/covid19-public/main/mysejahtera/trace_malaysia.csv"</span>
<span class="n">s</span><span class="o">=</span><span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">).</span><span class="n">content</span>
<span class="n">casual_contacts</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)))</span>
<span class="n">casual_contacts</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'dataset/trace_malaysia.csv'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">url</span><span class="o">=</span><span class="s">"https://raw.githubusercontent.com/MoH-Malaysia/covid19-public/main/epidemic/deaths_malaysia.csv"</span>
<span class="n">s</span><span class="o">=</span><span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">).</span><span class="n">content</span>
<span class="n">deaths_public</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)))</span>
<span class="n">deaths_public</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'dataset/deaths_malaysia.csv'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">url</span><span class="o">=</span><span class="s">"https://raw.githubusercontent.com/MoH-Malaysia/covid19-public/main/epidemic/deaths_state.csv"</span>
<span class="n">s</span><span class="o">=</span><span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">).</span><span class="n">content</span>
<span class="n">deaths_state</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)))</span>
<span class="n">deaths_state</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'dataset/death_state.csv'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">url</span><span class="o">=</span><span class="s">"https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/vaccinations/vaccinations.csv"</span>
<span class="n">s</span><span class="o">=</span><span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">).</span><span class="n">content</span>
<span class="n">vaccination_who</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)))</span>
<span class="n">vaccination_who</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'dataset/vaccinations.csv'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">url</span><span class="o">=</span><span class="s">"https://raw.githubusercontent.com/MoH-Malaysia/covid19-public/main/epidemic/tests_state.csv"</span>
<span class="n">s</span><span class="o">=</span><span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">).</span><span class="n">content</span>
<span class="n">tests_state</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)))</span>
<span class="n">tests_state</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'dataset/tests_state.csv'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">url</span><span class="o">=</span><span class="s">'https://raw.githubusercontent.com/MoH-Malaysia/covid19-public/main/static/population.csv'</span>
<span class="n">s</span><span class="o">=</span><span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">).</span><span class="n">content</span>
<span class="n">population</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)))</span>
<span class="n">population</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'dataset/population.csv'</span><span class="p">)</span>
</code></pre></div></div>

<p><a id="eda"></a></p>
<h1 id="eda">EDA</h1>

<p><a id="factor_corr"></a></p>
<h2 id="1-factors-that-correlates-to-the-number-of-new-cases">1. Factors that correlates to the number of new cases</h2>

<p><a id="factor_corr_c"></a></p>
<h3 id="data-cleaning">Data cleaning</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#make backup of the original dataframe
</span><span class="n">df_tests</span><span class="o">=</span><span class="n">tests</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_cases</span><span class="o">=</span><span class="n">cases</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_death_public</span><span class="o">=</span><span class="n">deaths_public</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_casual_contacts</span><span class="o">=</span><span class="n">casual_contacts</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#preview data
</span><span class="n">df_cases</span><span class="p">.</span><span class="n">tail</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>cases_new</th>
      <th>cases_import</th>
      <th>cases_recovered</th>
      <th>cluster_import</th>
      <th>cluster_religious</th>
      <th>cluster_community</th>
      <th>cluster_highRisk</th>
      <th>cluster_education</th>
      <th>cluster_detentionCentre</th>
      <th>cluster_workplace</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>604</th>
      <td>2021-09-20</td>
      <td>14345</td>
      <td>43</td>
      <td>16814</td>
      <td>24.0</td>
      <td>4.0</td>
      <td>447.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>10.0</td>
      <td>523.0</td>
    </tr>
    <tr>
      <th>605</th>
      <td>2021-09-21</td>
      <td>15759</td>
      <td>27</td>
      <td>16650</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>301.0</td>
      <td>45.0</td>
      <td>15.0</td>
      <td>2.0</td>
      <td>622.0</td>
    </tr>
    <tr>
      <th>606</th>
      <td>2021-09-22</td>
      <td>14990</td>
      <td>5</td>
      <td>19702</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>210.0</td>
      <td>35.0</td>
      <td>49.0</td>
      <td>17.0</td>
      <td>595.0</td>
    </tr>
    <tr>
      <th>607</th>
      <td>2021-09-23</td>
      <td>13754</td>
      <td>4</td>
      <td>16628</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>303.0</td>
      <td>20.0</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>658.0</td>
    </tr>
    <tr>
      <th>608</th>
      <td>2021-09-24</td>
      <td>14554</td>
      <td>9</td>
      <td>16751</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>405.0</td>
      <td>45.0</td>
      <td>34.0</td>
      <td>4.0</td>
      <td>582.0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#check for null values
</span><span class="k">print</span><span class="p">(</span><span class="n">df_tests</span><span class="p">.</span><span class="n">isna</span><span class="p">().</span><span class="nb">sum</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">df_cases</span><span class="p">.</span><span class="n">isna</span><span class="p">().</span><span class="nb">sum</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">df_casual_contacts</span><span class="p">.</span><span class="n">isna</span><span class="p">().</span><span class="nb">sum</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">df_death_public</span><span class="p">.</span><span class="n">isna</span><span class="p">().</span><span class="nb">sum</span><span class="p">())</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>date      0
rtk-ag    0
pcr       0
dtype: int64


date                         0
cases_new                    0
cases_import                 0
cases_recovered              0
cluster_import             342
cluster_religious          342
cluster_community          342
cluster_highRisk           342
cluster_education          342
cluster_detentionCentre    342
cluster_workplace          342
dtype: int64


date                0
casual_contacts     0
hide_large         50
hide_small         50
dtype: int64


date              0
deaths_new        0
deaths_new_dod    0
deaths_bid        0
deaths_bid_dod    0
dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#check data types
</span><span class="k">print</span><span class="p">(</span><span class="n">df_tests</span><span class="p">.</span><span class="n">dtypes</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">df_cases</span><span class="p">.</span><span class="n">dtypes</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">df_casual_contacts</span><span class="p">.</span><span class="n">dtypes</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">df_death_public</span><span class="p">.</span><span class="n">dtypes</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>date      object
rtk-ag     int64
pcr        int64
dtype: object


date                        object
cases_new                    int64
cases_import                 int64
cases_recovered              int64
cluster_import             float64
cluster_religious          float64
cluster_community          float64
cluster_highRisk           float64
cluster_education          float64
cluster_detentionCentre    float64
cluster_workplace          float64
dtype: object


date                object
casual_contacts      int64
hide_large         float64
hide_small         float64
dtype: object


date              object
deaths_new         int64
deaths_new_dod     int64
deaths_bid         int64
deaths_bid_dod     int64
dtype: object
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#convert date column into datetime
</span><span class="n">df_tests</span><span class="p">[</span><span class="s">'date'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_tests</span><span class="p">[</span><span class="s">'date'</span><span class="p">])</span>
<span class="n">df_cases</span><span class="p">[</span><span class="s">'date'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_cases</span><span class="p">[</span><span class="s">'date'</span><span class="p">])</span>
<span class="n">df_casual_contacts</span><span class="p">[</span><span class="s">'date'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_casual_contacts</span><span class="p">[</span><span class="s">'date'</span><span class="p">])</span>
<span class="n">df_death_public</span><span class="p">[</span><span class="s">'date'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_cases</span><span class="p">[</span><span class="s">'date'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#create dataframe with selected columns
</span><span class="n">df_cases_new</span><span class="o">=</span><span class="n">df_cases</span><span class="p">[[</span><span class="s">'date'</span><span class="p">,</span><span class="s">'cases_new'</span><span class="p">]]</span>
<span class="n">df_casual_contacts</span><span class="o">=</span><span class="n">df_casual_contacts</span><span class="p">[[</span><span class="s">'date'</span><span class="p">,</span><span class="s">'casual_contacts'</span><span class="p">]]</span>
<span class="n">df_death_total</span><span class="o">=</span><span class="n">df_death_public</span><span class="p">[[</span><span class="s">'date'</span><span class="p">,</span><span class="s">'deaths_new'</span><span class="p">]]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#merge dataframes
</span><span class="n">new_cases_and_tests</span> <span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_cases_new</span><span class="p">,</span><span class="n">df_tests</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s">"date"</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">'right'</span><span class="p">)</span>
<span class="n">test_cases_contacts</span> <span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">new_cases_and_tests</span><span class="p">,</span><span class="n">df_casual_contacts</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s">"date"</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s">'left'</span><span class="p">)</span>
<span class="n">df_merged</span> <span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">test_cases_contacts</span><span class="p">,</span><span class="n">df_death_total</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s">"date"</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s">'left'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#preview merged dataframe
</span><span class="n">df_merged</span><span class="p">.</span><span class="n">tail</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>cases_new</th>
      <th>rtk-ag</th>
      <th>pcr</th>
      <th>casual_contacts</th>
      <th>deaths_new</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>603</th>
      <td>2021-09-18</td>
      <td>15549.0</td>
      <td>53716</td>
      <td>51101</td>
      <td>35972.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>604</th>
      <td>2021-09-19</td>
      <td>14954.0</td>
      <td>70816</td>
      <td>38498</td>
      <td>35812.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>605</th>
      <td>2021-09-20</td>
      <td>14345.0</td>
      <td>120160</td>
      <td>45337</td>
      <td>44788.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>606</th>
      <td>2021-09-21</td>
      <td>15759.0</td>
      <td>110875</td>
      <td>52789</td>
      <td>41393.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>607</th>
      <td>2021-09-22</td>
      <td>14990.0</td>
      <td>127625</td>
      <td>48687</td>
      <td>44965.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#check for null values
</span><span class="n">df_merged</span><span class="p">.</span><span class="n">isna</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>date                 0
cases_new            1
rtk-ag               0
pcr                  0
casual_contacts    402
deaths_new          51
dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#handling null values
#Since theres a substantial amount of missing values,
#we will use iterative imputer. It will estimate the values according to the featues.
</span>
<span class="kn">from</span> <span class="nn">sklearn.experimental</span> <span class="kn">import</span> <span class="n">enable_iterative_imputer</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">IterativeImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="n">x</span><span class="o">=</span><span class="n">df_merged</span><span class="p">[[</span><span class="s">'cases_new'</span><span class="p">,</span><span class="s">'casual_contacts'</span><span class="p">,</span><span class="s">'pcr'</span><span class="p">,</span><span class="s">'rtk-ag'</span><span class="p">,</span><span class="s">'deaths_new'</span><span class="p">]]</span>

<span class="n">it_imputer</span> <span class="o">=</span> <span class="n">IterativeImputer</span><span class="p">(</span><span class="n">min_value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">it_imputer</span><span class="p">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="n">cleaned_df</span> <span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">df_merged</span><span class="p">[</span><span class="s">'date'</span><span class="p">],</span> <span class="n">left_index</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cleaned_df</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cases_new</th>
      <th>casual_contacts</th>
      <th>pcr</th>
      <th>rtk-ag</th>
      <th>deaths_new</th>
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>708.061210</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>2020-01-24</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.0</td>
      <td>713.251588</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>2.000000</td>
      <td>2020-01-25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>710.942841</td>
      <td>14.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>2020-01-26</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>713.344200</td>
      <td>24.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>2020-01-27</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>720.222053</td>
      <td>53.0</td>
      <td>0.0</td>
      <td>1.000000</td>
      <td>2020-01-28</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>603</th>
      <td>15549.0</td>
      <td>35972.000000</td>
      <td>51101.0</td>
      <td>53716.0</td>
      <td>408.310762</td>
      <td>2021-09-18</td>
    </tr>
    <tr>
      <th>604</th>
      <td>14954.0</td>
      <td>35812.000000</td>
      <td>38498.0</td>
      <td>70816.0</td>
      <td>383.149210</td>
      <td>2021-09-19</td>
    </tr>
    <tr>
      <th>605</th>
      <td>14345.0</td>
      <td>44788.000000</td>
      <td>45337.0</td>
      <td>120160.0</td>
      <td>336.497232</td>
      <td>2021-09-20</td>
    </tr>
    <tr>
      <th>606</th>
      <td>15759.0</td>
      <td>41393.000000</td>
      <td>52789.0</td>
      <td>110875.0</td>
      <td>386.767446</td>
      <td>2021-09-21</td>
    </tr>
    <tr>
      <th>607</th>
      <td>14990.0</td>
      <td>44965.000000</td>
      <td>48687.0</td>
      <td>127625.0</td>
      <td>353.002695</td>
      <td>2021-09-22</td>
    </tr>
  </tbody>
</table>
<p>608 rows × 6 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#convert numerical values to integer
</span><span class="n">cleaned_df</span><span class="p">[[</span><span class="s">'cases_new'</span><span class="p">,</span><span class="s">'casual_contacts'</span><span class="p">,</span><span class="s">'pcr'</span><span class="p">,</span> <span class="s">'rtk-ag'</span><span class="p">,</span><span class="s">'deaths_new'</span><span class="p">]]</span><span class="o">=</span><span class="n">cleaned_df</span><span class="p">[[</span><span class="s">'cases_new'</span><span class="p">,</span><span class="s">'casual_contacts'</span><span class="p">,</span><span class="s">'pcr'</span><span class="p">,</span> <span class="s">'rtk-ag'</span><span class="p">,</span><span class="s">'deaths_new'</span><span class="p">]].</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#sort values by date
</span><span class="n">cleaned_df</span><span class="p">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s">'date'</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cases_new</th>
      <th>casual_contacts</th>
      <th>pcr</th>
      <th>rtk-ag</th>
      <th>deaths_new</th>
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>708</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>2020-01-24</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>713</td>
      <td>5</td>
      <td>0</td>
      <td>2</td>
      <td>2020-01-25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>710</td>
      <td>14</td>
      <td>0</td>
      <td>0</td>
      <td>2020-01-26</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>713</td>
      <td>24</td>
      <td>0</td>
      <td>0</td>
      <td>2020-01-27</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>720</td>
      <td>53</td>
      <td>0</td>
      <td>1</td>
      <td>2020-01-28</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>603</th>
      <td>15549</td>
      <td>35972</td>
      <td>51101</td>
      <td>53716</td>
      <td>408</td>
      <td>2021-09-18</td>
    </tr>
    <tr>
      <th>604</th>
      <td>14954</td>
      <td>35812</td>
      <td>38498</td>
      <td>70816</td>
      <td>383</td>
      <td>2021-09-19</td>
    </tr>
    <tr>
      <th>605</th>
      <td>14345</td>
      <td>44788</td>
      <td>45337</td>
      <td>120160</td>
      <td>336</td>
      <td>2021-09-20</td>
    </tr>
    <tr>
      <th>606</th>
      <td>15759</td>
      <td>41393</td>
      <td>52789</td>
      <td>110875</td>
      <td>386</td>
      <td>2021-09-21</td>
    </tr>
    <tr>
      <th>607</th>
      <td>14990</td>
      <td>44965</td>
      <td>48687</td>
      <td>127625</td>
      <td>353</td>
      <td>2021-09-22</td>
    </tr>
  </tbody>
</table>
<p>608 rows × 6 columns</p>
</div>

<h3 id="visualization">Visualization</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">sns</span><span class="p">.</span><span class="n">set_style</span><span class="p">(</span><span class="s">"darkgrid"</span><span class="p">)</span>
</code></pre></div></div>

<p><a id="corr_var"></a></p>
<h4 id="correlation-between-variables">Correlation between variables</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#plot correlation heatmap
</span><span class="n">corr</span><span class="o">=</span><span class="n">cleaned_df</span><span class="p">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">sns</span><span class="p">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span><span class="n">annot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'mako'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Correlation Heatmap'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/ameerhaziq20/ameerhaziq20.github.io/main/_projects/Covid-19%20Malaysia%20Analysis%20And%20Prediction/output_30_0.png" alt="png" /></p>

<p><strong>Description:</strong> From the correlation matrix, we can see that there is a high positive correlation between death and new cases. This shows that as the count of new cases increase, the reported new death cases also increases. The amount of new cases is also have a high correlation with the amount of testing done. Among the two tests, rtk-ag test have a higher correlation coefficient than pcr. This may show that there are more positive cases reported by rtk-ag in comparison with pcr. Casual contacts also have a high correlation to the amount of new cases. This shows that casual contacts contributes to the amount of new covid cases.</p>

<p><a id="var_time_data"></a></p>
<h4 id="dataset-variables-value-over-time">Dataset variables value over time</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#plot multiple line graph
</span><span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Dataset variables value over time'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sns</span><span class="p">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">melt</span><span class="p">(</span><span class="n">cleaned_df</span><span class="p">,</span> <span class="s">'date'</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="s">"date"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'value'</span><span class="p">,</span><span class="n">hue</span><span class="o">=</span><span class="s">'variable'</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="s">'husl'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Date'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Count'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/ameerhaziq20/ameerhaziq20.github.io/main/_projects/Covid-19%20Malaysia%20Analysis%20And%20Prediction/output_33_0.png" alt="png" /></p>

<p><strong>Description:</strong> From the plot, we can see that the variables are having an upward trend as time progress. Notice the presence some occasional dips in the number of casual contacts everytime cases hits an all new time high which possibly due to the implementation of stricter Movement Control Order where people are refrained from travelling and even going out. This can be further seen on the filtered linegraph below.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#plot multiple line graph
</span><span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Casual contacts and new cases '</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s">"#FF0B04"</span><span class="p">,</span> <span class="s">"#4374B3"</span><span class="p">]</span>


<span class="n">sns</span><span class="p">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">melt</span><span class="p">(</span><span class="n">cleaned_df</span><span class="p">[[</span><span class="s">'cases_new'</span><span class="p">,</span><span class="s">'casual_contacts'</span><span class="p">,</span><span class="s">'date'</span><span class="p">]],</span> <span class="s">'date'</span><span class="p">),</span>
             <span class="n">x</span><span class="o">=</span><span class="s">"date"</span><span class="p">,</span>
             <span class="n">y</span><span class="o">=</span><span class="s">'value'</span><span class="p">,</span>
             <span class="n">hue</span><span class="o">=</span><span class="s">'variable'</span><span class="p">,</span>
             <span class="n">palette</span><span class="o">=</span><span class="n">colors</span>
            <span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Date'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Count'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/ameerhaziq20/ameerhaziq20.github.io/main/_projects/Covid-19%20Malaysia%20Analysis%20And%20Prediction/output_35_0.png" alt="png" /></p>

<p><strong>Description:</strong> Here we can have a clearer view on the occasional dips in the number of casual contacts everytime cases hits an all new time high as mentioned from the previous description.</p>

<p><a id="herd_immunity"></a></p>
<h2 id="2-vaccination">2. Vaccination</h2>

<p>Based on the government’s target, we need to have 80% of the population fully vaccinated against Covid-19 in order to achieve herd immunity.</p>

<p><a id="herd_immunity_c"></a></p>
<h3 id="data-cleaning-1">Data cleaning</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#make a backup of the dataframe
</span><span class="n">df_vaccination</span> <span class="o">=</span> <span class="n">vaccination_who</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_population</span> <span class="o">=</span> <span class="n">population</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#preview the dataframe
</span><span class="n">df_vaccination</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>location</th>
      <th>iso_code</th>
      <th>date</th>
      <th>total_vaccinations</th>
      <th>people_vaccinated</th>
      <th>people_fully_vaccinated</th>
      <th>total_boosters</th>
      <th>daily_vaccinations_raw</th>
      <th>daily_vaccinations</th>
      <th>total_vaccinations_per_hundred</th>
      <th>people_vaccinated_per_hundred</th>
      <th>people_fully_vaccinated_per_hundred</th>
      <th>total_boosters_per_hundred</th>
      <th>daily_vaccinations_per_million</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>AFG</td>
      <td>2021-02-22</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afghanistan</td>
      <td>AFG</td>
      <td>2021-02-23</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1367.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>34.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afghanistan</td>
      <td>AFG</td>
      <td>2021-02-24</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1367.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>34.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Afghanistan</td>
      <td>AFG</td>
      <td>2021-02-25</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1367.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>34.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Afghanistan</td>
      <td>AFG</td>
      <td>2021-02-26</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1367.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>34.0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#preview the dataframe
</span><span class="n">df_population</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>idxs</th>
      <th>pop</th>
      <th>pop_18</th>
      <th>pop_60</th>
      <th>pop_12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Malaysia</td>
      <td>0</td>
      <td>32657400</td>
      <td>23409600</td>
      <td>3502000</td>
      <td>3147500</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Johor</td>
      <td>1</td>
      <td>3781000</td>
      <td>2711900</td>
      <td>428700</td>
      <td>359900</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Kedah</td>
      <td>2</td>
      <td>2185100</td>
      <td>1540600</td>
      <td>272500</td>
      <td>211400</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Kelantan</td>
      <td>3</td>
      <td>1906700</td>
      <td>1236200</td>
      <td>194100</td>
      <td>210600</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Melaka</td>
      <td>4</td>
      <td>932700</td>
      <td>677400</td>
      <td>118500</td>
      <td>86500</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#filter column and rows with data for Malaysia
</span><span class="n">df_population</span> <span class="o">=</span> <span class="n">df_population</span><span class="p">[</span><span class="n">df_population</span><span class="p">[</span><span class="s">'state'</span><span class="p">]</span><span class="o">==</span><span class="s">'Malaysia'</span><span class="p">]</span>
<span class="n">df_vaccination</span> <span class="o">=</span> <span class="n">df_vaccination</span><span class="p">[</span><span class="n">df_vaccination</span><span class="p">[</span><span class="s">'iso_code'</span><span class="p">]</span> <span class="o">==</span><span class="s">'MYS'</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#create new dataframe with selected columns
</span><span class="n">df_vax_col</span> <span class="o">=</span> <span class="n">df_vaccination</span><span class="p">[[</span><span class="s">'date'</span><span class="p">,</span> <span class="s">'total_vaccinations'</span><span class="p">,</span> <span class="s">'people_vaccinated'</span> <span class="p">,</span> <span class="s">'people_fully_vaccinated'</span><span class="p">,</span><span class="s">'daily_vaccinations'</span><span class="p">]]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#convert date column to datetime
</span><span class="n">df_vax_col</span><span class="p">[</span><span class="s">'date'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_vax_col</span><span class="p">[</span><span class="s">'date'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;ipython-input-32-087e617b6292&gt;:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_vax_col['date'] = pd.to_datetime(df_vax_col['date'])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#check for null values
</span><span class="k">print</span><span class="p">(</span><span class="n">df_vax_col</span><span class="p">.</span><span class="n">isna</span><span class="p">().</span><span class="nb">sum</span><span class="p">())</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>date                       0
total_vaccinations         0
people_vaccinated          0
people_fully_vaccinated    2
daily_vaccinations         1
dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#drop null rows
</span><span class="n">df_vax_col</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;ipython-input-34-ef025bb1d682&gt;:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_vax_col.dropna(inplace=True)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#preview dataframe
</span><span class="n">df_vax_col</span><span class="p">.</span><span class="n">tail</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>total_vaccinations</th>
      <th>people_vaccinated</th>
      <th>people_fully_vaccinated</th>
      <th>daily_vaccinations</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>27655</th>
      <td>2021-09-19</td>
      <td>40375056.0</td>
      <td>22003333.0</td>
      <td>18453322.0</td>
      <td>230267.0</td>
    </tr>
    <tr>
      <th>27656</th>
      <td>2021-09-20</td>
      <td>40664674.0</td>
      <td>22099719.0</td>
      <td>18648795.0</td>
      <td>239191.0</td>
    </tr>
    <tr>
      <th>27657</th>
      <td>2021-09-21</td>
      <td>40925929.0</td>
      <td>22226325.0</td>
      <td>18786636.0</td>
      <td>241660.0</td>
    </tr>
    <tr>
      <th>27658</th>
      <td>2021-09-22</td>
      <td>41247271.0</td>
      <td>22351561.0</td>
      <td>18986347.0</td>
      <td>252022.0</td>
    </tr>
    <tr>
      <th>27659</th>
      <td>2021-09-23</td>
      <td>41573883.0</td>
      <td>22482988.0</td>
      <td>19180397.0</td>
      <td>269781.0</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="visualization-1">Visualization</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#create pandas series from column
</span><span class="n">df_pop</span> <span class="o">=</span> <span class="n">df_population</span><span class="p">[</span><span class="s">'pop'</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#merge dataframes
</span><span class="n">df_vax_herd</span> <span class="o">=</span> <span class="n">df_vax_col</span><span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_pop</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">'cross'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#preview dataframes
</span><span class="n">df_vax_col</span><span class="p">.</span><span class="n">tail</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>total_vaccinations</th>
      <th>people_vaccinated</th>
      <th>people_fully_vaccinated</th>
      <th>daily_vaccinations</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>27655</th>
      <td>2021-09-19</td>
      <td>40375056.0</td>
      <td>22003333.0</td>
      <td>18453322.0</td>
      <td>230267.0</td>
    </tr>
    <tr>
      <th>27656</th>
      <td>2021-09-20</td>
      <td>40664674.0</td>
      <td>22099719.0</td>
      <td>18648795.0</td>
      <td>239191.0</td>
    </tr>
    <tr>
      <th>27657</th>
      <td>2021-09-21</td>
      <td>40925929.0</td>
      <td>22226325.0</td>
      <td>18786636.0</td>
      <td>241660.0</td>
    </tr>
    <tr>
      <th>27658</th>
      <td>2021-09-22</td>
      <td>41247271.0</td>
      <td>22351561.0</td>
      <td>18986347.0</td>
      <td>252022.0</td>
    </tr>
    <tr>
      <th>27659</th>
      <td>2021-09-23</td>
      <td>41573883.0</td>
      <td>22482988.0</td>
      <td>19180397.0</td>
      <td>269781.0</td>
    </tr>
  </tbody>
</table>
</div>

<p><a id="vac_prog"></a></p>
<h4 id="plot-of-vaccination-progress-in-malaysia">Plot of vaccination progress in Malaysia</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#plot multiple line graph
</span><span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">date</span> <span class="o">=</span> <span class="n">df_vax_herd</span><span class="p">[</span><span class="s">'date'</span><span class="p">]</span>
<span class="n">sns</span><span class="p">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">date</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df_vax_herd</span><span class="p">[</span><span class="s">'total_vaccinations'</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s">"Total vaccinations"</span><span class="p">)</span>
<span class="n">sns</span><span class="p">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">date</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df_vax_herd</span><span class="p">[</span><span class="s">'people_vaccinated'</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s">"People with 1st Dose"</span><span class="p">)</span>
<span class="n">sns</span><span class="p">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">date</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df_vax_herd</span><span class="p">[</span><span class="s">'people_fully_vaccinated'</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s">"People with 2nd Dose"</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">'Vaccination Progress in Malaysia'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Date'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Count'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/ameerhaziq20/ameerhaziq20.github.io/main/_projects/Covid-19%20Malaysia%20Analysis%20And%20Prediction/output_54_0.png" alt="png" /></p>

<p><a id="full_vac"></a></p>
<h4 id="percentage-of-fully-vaccinated-count-against-population">Percentage of fully vaccinated count against population</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#calculate current herd immunity percentage
</span><span class="n">vax_pop</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_vax_herd</span><span class="p">[</span><span class="s">'people_fully_vaccinated'</span><span class="p">].</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:,]</span> <span class="o">/</span> <span class="n">df_vax_herd</span><span class="p">[</span><span class="s">'pop'</span><span class="p">].</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:,])</span> <span class="o">*</span> <span class="mi">100</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#plot pie chart
</span><span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="k">as</span> <span class="n">mtick</span>

<span class="n">np_vax</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="o">-</span><span class="n">vax_pop</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">vax_pop</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">np_vax</span><span class="p">)</span>
<span class="n">explode</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.05</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="s">'Fully vaccinated'</span><span class="p">,</span> <span class="s">'Not-fully vaccinated'</span>
<span class="n">sizes</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span>

<span class="n">fig1</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax1</span><span class="p">.</span><span class="n">pie</span><span class="p">(</span><span class="n">sizes</span><span class="p">,</span> <span class="n">explode</span><span class="o">=</span><span class="n">explode</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">autopct</span><span class="o">=</span><span class="s">'%1.1f%%'</span><span class="p">,</span>
        <span class="n">shadow</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="n">yaxis</span><span class="p">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mtick</span><span class="p">.</span><span class="n">PercentFormatter</span><span class="p">())</span>
<span class="n">ax1</span><span class="p">.</span><span class="n">axis</span><span class="p">(</span><span class="s">'equal'</span><span class="p">)</span>

<span class="n">ax1</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">'% Vaccination progress'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/ameerhaziq20/ameerhaziq20.github.io/main/_projects/Covid-19%20Malaysia%20Analysis%20And%20Prediction/output_57_0.png" alt="png" /></p>

<p><a id="vac_time"></a></p>
<h4 id="percentage-of-fully-vaccinated-count-across-time">Percentage of fully vaccinated count across time</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#calculate herd immunity percentage
</span><span class="n">df_vax_herd</span><span class="p">[</span><span class="s">'vax_percentage'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_vax_herd</span><span class="p">[</span><span class="s">'people_fully_vaccinated'</span><span class="p">]</span> <span class="o">/</span> <span class="n">df_vax_herd</span><span class="p">[</span><span class="s">'pop'</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#plot line graph
</span><span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">sns</span><span class="p">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df_vax_herd</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">df_vax_herd</span><span class="p">[</span><span class="s">'date'</span><span class="p">],</span><span class="n">y</span><span class="o">=</span><span class="n">df_vax_herd</span><span class="p">[</span><span class="s">'vax_percentage'</span><span class="p">])</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Covid-19 Herd Immunity Progress in Malaysia"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"Date"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"Percentage"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/ameerhaziq20/ameerhaziq20.github.io/main/_projects/Covid-19%20Malaysia%20Analysis%20And%20Prediction/output_60_0.png" alt="png" /></p>

<p><strong>Description:</strong> The vaccine admnistration had exponentially increased with a slight decreased rate aproaching September 2021.</p>

<p><a id="state_case"></a></p>
<h2 id="3-count-of-new-cases-by-state">3. Count of new cases by state</h2>

<p><a id="state_case_c"></a></p>
<h3 id="data-cleaning-2">Data Cleaning</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#create a copy of the original datafarme
</span><span class="n">df_state_cases</span><span class="o">=</span><span class="n">state_cases</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_death_public</span><span class="o">=</span><span class="n">deaths_public</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_death_state</span><span class="o">=</span><span class="n">deaths_state</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#preview dataframe
</span><span class="n">df_state_cases</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>state</th>
      <th>cases_import</th>
      <th>cases_new</th>
      <th>cases_recovered</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-01-25</td>
      <td>Johor</td>
      <td>4</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-01-25</td>
      <td>Kedah</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-01-25</td>
      <td>Kelantan</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-01-25</td>
      <td>Melaka</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-01-25</td>
      <td>Negeri Sembilan</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#convert date to datetime
</span><span class="n">df_state_cases</span><span class="p">[</span><span class="s">'date'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_state_cases</span><span class="p">[</span><span class="s">'date'</span><span class="p">])</span>
<span class="n">df_death_public</span><span class="p">[</span><span class="s">'date'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_death_public</span><span class="p">[</span><span class="s">'date'</span><span class="p">])</span>
<span class="n">df_death_state</span><span class="p">[</span><span class="s">'date'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_death_state</span><span class="p">[</span><span class="s">'date'</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#check for null values
</span><span class="n">df_state_cases</span><span class="p">.</span><span class="n">isna</span><span class="p">().</span><span class="nb">sum</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>date               0
state              0
cases_import       0
cases_new          0
cases_recovered    0
dtype: int64
</code></pre></div></div>

<h3 id="visualization-2">Visualization</h3>

<p><a id="state_case_plot"></a></p>
<h4 id="plot-of-new-cases-for-each-state-over-time">Plot of new cases for each state over time</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#scatter plot values over time
</span><span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Covid cases according to state"</span><span class="p">)</span>

<span class="n">sns</span><span class="p">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s">'cases_new'</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'date'</span><span class="p">,</span><span class="n">hue</span><span class="o">=</span><span class="s">'state'</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="s">"state"</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df_state_cases</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'Date'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Count of new cases'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/ameerhaziq20/ameerhaziq20.github.io/main/_projects/Covid-19%20Malaysia%20Analysis%20And%20Prediction/output_70_0.png" alt="png" /></p>

<p><strong>Description:</strong> The plot shows that Selangor had significatly more cases throughout the time.Around April 2021, there is a low dip after the second ATH that occured around February 2021, and continued to increase exponantially going forward until August before droping to lower count of new cases.</p>

<p><a id="test_state"></a></p>
<h2 id="4-count-of-covid-tests-by-state">4. Count of Covid tests by state</h2>

<p><a id="test_state_c"></a></p>
<h3 id="data-cleaning-3">Data cleaning</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#make a copy of the dataframe
</span><span class="n">df_tests_state</span> <span class="o">=</span> <span class="n">tests_state</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#create sum of tests by state
</span><span class="n">df_ts</span> <span class="o">=</span> <span class="n">df_tests_state</span><span class="p">.</span><span class="n">groupby</span><span class="p">([</span><span class="s">'state'</span><span class="p">]).</span><span class="nb">sum</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#reset index
</span><span class="n">df_ts</span><span class="p">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#create new column with sum of both testing values
</span><span class="n">df_ts</span><span class="p">[</span><span class="s">'total_test'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_ts</span><span class="p">[</span><span class="s">'rtk-ag'</span><span class="p">]</span> <span class="o">+</span> <span class="n">df_ts</span><span class="p">[</span><span class="s">'pcr'</span><span class="p">])</span>
</code></pre></div></div>

<h3 id="visualization-3">Visualization</h3>

<p><a id="test_state_plot"></a></p>
<h4 id="plot-of-total-covid-tests-by-state">Plot of total Covid tests by state</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#plot bar chart
</span><span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Covid Tests by State"</span><span class="p">)</span>
<span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">"state"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">"total_test"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_ts</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">'State'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">'Sum of Covid Tests'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/ameerhaziq20/ameerhaziq20.github.io/main/_projects/Covid-19%20Malaysia%20Analysis%20And%20Prediction/output_80_0.png" alt="png" /></p>

<p><strong>Description:</strong> From the Covid Tests by State plot, we can see the top 3 states that have run the most test are Selangor, Johor, and, Sarawak. Despite being near to the Selangor state, W.P Putrajaya had significatly fewer tests done in the area.</p>

<p><a id="new_case_proph"></a></p>
<h1 id="covid-19-new-cases-forecast">Covid-19 new cases forecast</h1>

<p><a id="proph_prep"></a></p>
<h3 id="data-preparation">Data preparation</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Prophet Dependencies
#!pip install pystan==2.19.1.1
#!pip install prophet
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#if unable to install
#conda install --override-channels -c main -c conda-forge boost
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#import prophet
</span><span class="kn">from</span> <span class="nn">prophet</span> <span class="kn">import</span> <span class="n">Prophet</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Importing plotly failed. Interactive plots will not work.
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#make a copy of the original dataframe
</span><span class="n">pdf</span> <span class="o">=</span> <span class="n">df_cases</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">pdf</span><span class="p">.</span><span class="n">tail</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>cases_new</th>
      <th>cases_import</th>
      <th>cases_recovered</th>
      <th>cluster_import</th>
      <th>cluster_religious</th>
      <th>cluster_community</th>
      <th>cluster_highRisk</th>
      <th>cluster_education</th>
      <th>cluster_detentionCentre</th>
      <th>cluster_workplace</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>604</th>
      <td>2021-09-20</td>
      <td>14345</td>
      <td>43</td>
      <td>16814</td>
      <td>24.0</td>
      <td>4.0</td>
      <td>447.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>10.0</td>
      <td>523.0</td>
    </tr>
    <tr>
      <th>605</th>
      <td>2021-09-21</td>
      <td>15759</td>
      <td>27</td>
      <td>16650</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>301.0</td>
      <td>45.0</td>
      <td>15.0</td>
      <td>2.0</td>
      <td>622.0</td>
    </tr>
    <tr>
      <th>606</th>
      <td>2021-09-22</td>
      <td>14990</td>
      <td>5</td>
      <td>19702</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>210.0</td>
      <td>35.0</td>
      <td>49.0</td>
      <td>17.0</td>
      <td>595.0</td>
    </tr>
    <tr>
      <th>607</th>
      <td>2021-09-23</td>
      <td>13754</td>
      <td>4</td>
      <td>16628</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>303.0</td>
      <td>20.0</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>658.0</td>
    </tr>
    <tr>
      <th>608</th>
      <td>2021-09-24</td>
      <td>14554</td>
      <td>9</td>
      <td>16751</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>405.0</td>
      <td>45.0</td>
      <td>34.0</td>
      <td>4.0</td>
      <td>582.0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#check data types of the dataframe columns
</span><span class="n">pdf</span><span class="p">.</span><span class="n">dtypes</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>date                       datetime64[ns]
cases_new                           int64
cases_import                        int64
cases_recovered                     int64
cluster_import                    float64
cluster_religious                 float64
cluster_community                 float64
cluster_highRisk                  float64
cluster_education                 float64
cluster_detentionCentre           float64
cluster_workplace                 float64
dtype: object
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#create y and ds dataframe
</span><span class="n">pdf</span><span class="o">=</span><span class="n">pdf</span><span class="p">[[</span><span class="s">'cases_new'</span><span class="p">,</span><span class="s">'date'</span><span class="p">]]</span>
<span class="n">pdf</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'y'</span><span class="p">,</span> <span class="s">'ds'</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#preview the dataframe
</span><span class="n">pdf</span><span class="p">.</span><span class="n">tail</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>y</th>
      <th>ds</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>604</th>
      <td>14345</td>
      <td>2021-09-20</td>
    </tr>
    <tr>
      <th>605</th>
      <td>15759</td>
      <td>2021-09-21</td>
    </tr>
    <tr>
      <th>606</th>
      <td>14990</td>
      <td>2021-09-22</td>
    </tr>
    <tr>
      <th>607</th>
      <td>13754</td>
      <td>2021-09-23</td>
    </tr>
    <tr>
      <th>608</th>
      <td>14554</td>
      <td>2021-09-24</td>
    </tr>
  </tbody>
</table>
</div>

<p><a id="hyperparameter"></a></p>
<h3 id="hyperparameter-tuning">Hyperparameter tuning</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#hyperparameter tuning
</span>
<span class="kn">import</span> <span class="nn">itertools</span>    
<span class="kn">from</span> <span class="nn">prophet.diagnostics</span> <span class="kn">import</span> <span class="n">cross_validation</span>
<span class="kn">from</span> <span class="nn">prophet.diagnostics</span> <span class="kn">import</span> <span class="n">performance_metrics</span>


<span class="c1">#cutoffs = pd.to_datetime(['2013-02-15', '2013-08-15', '2014-02-15'])
</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>  
    <span class="s">'changepoint_prior_scale'</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
    <span class="s">'seasonality_prior_scale'</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span>
<span class="p">}</span>

<span class="c1"># Generate all combinations of parameters
</span><span class="n">all_params</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">param_grid</span><span class="p">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">itertools</span><span class="p">.</span><span class="n">product</span><span class="p">(</span><span class="o">*</span><span class="n">param_grid</span><span class="p">.</span><span class="n">values</span><span class="p">())]</span>
<span class="n">rmses</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Store the RMSEs for each params here
</span>
<span class="c1"># Use cross validation to evaluate all parameters
</span><span class="k">for</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">all_params</span><span class="p">:</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">Prophet</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">).</span><span class="n">fit</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span>  <span class="c1"># Fit model with given params
</span>    <span class="n">df_cv</span> <span class="o">=</span> <span class="n">cross_validation</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="s">'467 days'</span><span class="p">,</span> <span class="n">horizon</span><span class="o">=</span><span class="s">'90 days'</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="s">"processes"</span><span class="p">)</span>
    <span class="n">df_p</span> <span class="o">=</span> <span class="n">performance_metrics</span><span class="p">(</span><span class="n">df_cv</span><span class="p">,</span> <span class="n">rolling_window</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">rmses</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_p</span><span class="p">[</span><span class="s">'rmse'</span><span class="p">].</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Find the best parameters
</span><span class="n">tuning_results</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">all_params</span><span class="p">)</span>
<span class="n">tuning_results</span><span class="p">[</span><span class="s">'rmse'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rmses</span>
<span class="k">print</span><span class="p">(</span><span class="n">tuning_results</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    changepoint_prior_scale  seasonality_prior_scale          rmse
0                     0.001                     0.01  10509.584196
1                     0.001                     0.10  10521.955572
2                     0.001                     1.00  10487.059482
3                     0.001                    10.00  10488.864141
4                     0.010                     0.01   9975.077664
5                     0.010                     0.10   9954.562702
6                     0.010                     1.00   9957.597011
7                     0.010                    10.00   9969.145111
8                     0.100                     0.01   8347.351167
9                     0.100                     0.10   8378.579068
10                    0.100                     1.00   8404.641119
11                    0.100                    10.00   8439.874761
12                    0.500                     0.01   8253.356831
13                    0.500                     0.10   8240.275750
14                    0.500                     1.00   8279.865321
15                    0.500                    10.00   8255.842907
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#show best parameters for the model
</span><span class="n">best_params</span> <span class="o">=</span> <span class="n">all_params</span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">rmses</span><span class="p">)]</span>
<span class="k">print</span><span class="p">(</span><span class="n">best_params</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{'changepoint_prior_scale': 0.5, 'seasonality_prior_scale': 0.1}
</code></pre></div></div>

<p><a id="forc_new"></a></p>
<h3 id="forecast-new-cases">Forecast new cases</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#fit prophet model
</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">Prophet</span><span class="p">(</span><span class="n">interval_width</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
        <span class="n">yearly_seasonality</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">seasonality_mode</span><span class="o">=</span><span class="s">'additive'</span><span class="p">,</span>
        <span class="n">changepoint_prior_scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">seasonality_prior_scale</span><span class="o">=</span><span class="mf">0.1</span>
           <span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">pdf</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>INFO:prophet:Disabling daily seasonality. Run prophet with daily_seasonality=True to override this.
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#forecast future values and view the results
</span><span class="n">future</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">make_future_dataframe</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="s">'D'</span><span class="p">)</span>
<span class="n">forecast</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">future</span><span class="p">)</span>
<span class="n">forecast</span><span class="p">.</span><span class="n">tail</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ds</th>
      <th>trend</th>
      <th>yhat_lower</th>
      <th>yhat_upper</th>
      <th>trend_lower</th>
      <th>trend_upper</th>
      <th>additive_terms</th>
      <th>additive_terms_lower</th>
      <th>additive_terms_upper</th>
      <th>weekly</th>
      <th>weekly_lower</th>
      <th>weekly_upper</th>
      <th>yearly</th>
      <th>yearly_lower</th>
      <th>yearly_upper</th>
      <th>multiplicative_terms</th>
      <th>multiplicative_terms_lower</th>
      <th>multiplicative_terms_upper</th>
      <th>yhat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>634</th>
      <td>2021-10-20</td>
      <td>5611.351674</td>
      <td>7353.892521</td>
      <td>13286.924934</td>
      <td>2395.438961</td>
      <td>8285.669366</td>
      <td>4911.917531</td>
      <td>4911.917531</td>
      <td>4911.917531</td>
      <td>48.355733</td>
      <td>48.355733</td>
      <td>48.355733</td>
      <td>4863.561797</td>
      <td>4863.561797</td>
      <td>4863.561797</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10523.269204</td>
    </tr>
    <tr>
      <th>635</th>
      <td>2021-10-21</td>
      <td>5555.250374</td>
      <td>7181.261022</td>
      <td>13309.922767</td>
      <td>2217.641999</td>
      <td>8437.315873</td>
      <td>4964.928067</td>
      <td>4964.928067</td>
      <td>4964.928067</td>
      <td>192.799745</td>
      <td>192.799745</td>
      <td>192.799745</td>
      <td>4772.128322</td>
      <td>4772.128322</td>
      <td>4772.128322</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10520.178441</td>
    </tr>
    <tr>
      <th>636</th>
      <td>2021-10-22</td>
      <td>5499.149074</td>
      <td>6686.256518</td>
      <td>13644.236939</td>
      <td>2038.771335</td>
      <td>8606.513410</td>
      <td>4902.319216</td>
      <td>4902.319216</td>
      <td>4902.319216</td>
      <td>221.824781</td>
      <td>221.824781</td>
      <td>221.824781</td>
      <td>4680.494434</td>
      <td>4680.494434</td>
      <td>4680.494434</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10401.468290</td>
    </tr>
    <tr>
      <th>637</th>
      <td>2021-10-23</td>
      <td>5443.047774</td>
      <td>6500.725451</td>
      <td>13524.667446</td>
      <td>1703.786879</td>
      <td>8767.015970</td>
      <td>4710.491372</td>
      <td>4710.491372</td>
      <td>4710.491372</td>
      <td>121.839013</td>
      <td>121.839013</td>
      <td>121.839013</td>
      <td>4588.652358</td>
      <td>4588.652358</td>
      <td>4588.652358</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10153.539146</td>
    </tr>
    <tr>
      <th>638</th>
      <td>2021-10-24</td>
      <td>5386.946475</td>
      <td>5972.191747</td>
      <td>13106.366017</td>
      <td>1397.371264</td>
      <td>8862.420933</td>
      <td>4403.461618</td>
      <td>4403.461618</td>
      <td>4403.461618</td>
      <td>-93.149827</td>
      <td>-93.149827</td>
      <td>-93.149827</td>
      <td>4496.611445</td>
      <td>4496.611445</td>
      <td>4496.611445</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>9790.408093</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#view for specific date
</span><span class="n">forecast</span><span class="p">[</span><span class="n">forecast</span><span class="p">[</span><span class="s">'ds'</span><span class="p">]</span><span class="o">==</span><span class="s">'2021-09-29'</span><span class="p">]</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ds</th>
      <th>trend</th>
      <th>yhat_lower</th>
      <th>yhat_upper</th>
      <th>trend_lower</th>
      <th>trend_upper</th>
      <th>additive_terms</th>
      <th>additive_terms_lower</th>
      <th>additive_terms_upper</th>
      <th>weekly</th>
      <th>weekly_lower</th>
      <th>weekly_upper</th>
      <th>yearly</th>
      <th>yearly_lower</th>
      <th>yearly_upper</th>
      <th>multiplicative_terms</th>
      <th>multiplicative_terms_lower</th>
      <th>multiplicative_terms_upper</th>
      <th>yhat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>613</th>
      <td>2021-09-29</td>
      <td>6789.478968</td>
      <td>12806.58505</td>
      <td>14988.722248</td>
      <td>6540.48628</td>
      <td>7007.24081</td>
      <td>7077.09217</td>
      <td>7077.09217</td>
      <td>7077.09217</td>
      <td>48.355733</td>
      <td>48.355733</td>
      <td>48.355733</td>
      <td>7028.736436</td>
      <td>7028.736436</td>
      <td>7028.736436</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>13866.571138</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#plot the forecast
</span><span class="n">plot1</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">forecast</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/ameerhaziq20/ameerhaziq20.github.io/main/_projects/Covid-19%20Malaysia%20Analysis%20And%20Prediction/output_98_0.png" alt="png" /></p>

<p><strong>Description:</strong> From the component plot, we can see that there is currently an upward trend in the number of new Covid-19 cases in Malaysia. As for the next 30 days, it is expcted cases to be around 9790 cases with a 5972 lower bound of the uncertainty interval, and 13106 upper bound of the uncertainty interval.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#plot the components
</span><span class="n">plt2</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">plot_components</span><span class="p">(</span><span class="n">forecast</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/ameerhaziq20/ameerhaziq20.github.io/main/_projects/Covid-19%20Malaysia%20Analysis%20And%20Prediction/output_100_0.png" alt="png" /></p>

<p><strong>Description:</strong> From the componenets plot, we can see a strong uptrend from the beginning of August 2020 with a slowed rate around March 2021 before starting an increased rate afterwards. We can see that cases are mostly lower at Monday, increases through the week and drops slightly after Friday. There are also more cases happens around August and starts a downward trend going forward.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#save and export model
</span><span class="kn">import</span> <span class="nn">pickle</span>
<span class="n">prophet_model_save</span> <span class="o">=</span> <span class="s">'prophet_model.sav'</span>
<span class="n">pickle</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">prophet_model_save</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">))</span>
</code></pre></div></div>

<p><a id="pred_model"></a></p>
<h1 id="prediction-model">Prediction Model</h1>

<p><a id="pred_proc"></a></p>
<h2 id="data-preprocessing">Data preprocessing</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#make a copy of the dataframe
</span><span class="n">df</span><span class="o">=</span><span class="n">cleaned_df</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#drop date column
</span><span class="n">df</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'date'</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#seperate label and features
</span><span class="n">y</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s">'cases_new'</span><span class="p">]</span>
<span class="n">X</span><span class="o">=</span><span class="n">df</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'cases_new'</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#preview the features
</span><span class="n">X</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>casual_contacts</th>
      <th>pcr</th>
      <th>rtk-ag</th>
      <th>deaths_new</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>708</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>713</td>
      <td>5</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>710</td>
      <td>14</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>713</td>
      <td>24</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>720</td>
      <td>53</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<p><a id="train_eval"></a></p>
<h2 id="training-and-evaluation">Training and evaluation</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#scale the data 
</span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">,</span><span class="n">RobustScaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">scaler</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1">#splitting the data
</span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#import the models
</span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Lasso</span>

<span class="c1">#define models
</span><span class="n">rid_model</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
<span class="n">lin_model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">las_model</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>

<span class="c1">#fit model to data
</span><span class="n">rid_model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">lin_model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">las_model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Lasso(alpha=18)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#model score
</span><span class="k">print</span><span class="p">(</span><span class="n">rid_model</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">lin_model</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">las_model</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.9555444130813269
0.9555740069562761
0.9555138155753014
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#find best alpha value for lasso
</span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LassoCV</span>
<span class="n">lass_cv</span> <span class="o">=</span> <span class="n">LassoCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">18</span><span class="p">])</span>

<span class="n">model_cv</span> <span class="o">=</span> <span class="n">lass_cv</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">model_cv</span><span class="p">.</span><span class="n">alpha_</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>18
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#find best alpha value for ridge
</span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">RidgeCV</span>
<span class="n">regr_cv</span> <span class="o">=</span> <span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">])</span>

<span class="n">model_cv</span> <span class="o">=</span> <span class="n">regr_cv</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">model_cv</span><span class="p">.</span><span class="n">alpha_</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2.5
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#make predictions
</span><span class="n">rid_pred</span> <span class="o">=</span> <span class="n">rid_model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">lin_pred</span> <span class="o">=</span> <span class="n">lin_model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">las_pred</span> <span class="o">=</span> <span class="n">las_model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1">#r2 score
</span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span> <span class="k">as</span> <span class="n">r2</span>
<span class="k">print</span><span class="p">(</span><span class="n">r2</span><span class="p">(</span><span class="n">rid_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">r2</span><span class="p">(</span><span class="n">lin_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">r2</span><span class="p">(</span><span class="n">las_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.9622378384917039
0.9622989469948486
0.9622047617781965
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#plot prediction results
</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">fig</span><span class="p">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mf">18.5</span><span class="p">,</span> <span class="mf">10.5</span><span class="p">)</span>

<span class="n">fig</span><span class="p">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s">"Regression's Prediction Results"</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">rid_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span><span class="s">'o'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Ridge Regression'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'Actual'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'Predicted'</span><span class="p">)</span>
<span class="n">m</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">rid_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">rid_pred</span><span class="p">,</span> <span class="n">m</span><span class="o">*</span><span class="n">rid_pred</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>


<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">lin_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span><span class="s">'o'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Linear Regression'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'Actual'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'Predicted'</span><span class="p">)</span>
<span class="n">m</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">lin_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">lin_pred</span><span class="p">,</span> <span class="n">m</span><span class="o">*</span><span class="n">lin_pred</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>


<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">las_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span><span class="s">'o'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">set_title</span><span class="p">(</span><span class="s">'Lasso Regression'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'Actual'</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'Predicted'</span><span class="p">)</span>
<span class="n">m</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">las_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">plot</span><span class="p">(</span><span class="n">las_pred</span><span class="p">,</span> <span class="n">m</span><span class="o">*</span><span class="n">las_pred</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/ameerhaziq20/ameerhaziq20.github.io/main/_projects/Covid-19%20Malaysia%20Analysis%20And%20Prediction/output_116_0.png" alt="png" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Figure size 1008x576 with 0 Axes&gt;
</code></pre></div></div>

<p><strong>Description:</strong> we can see that most of the models performed well with r2 scores approximately 0.96. From the results, we can see that linear regression performed the best at predicting new cases using this dataset.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># get importance for linear regression
</span><span class="n">importance</span> <span class="o">=</span> <span class="n">lin_model</span><span class="p">.</span><span class="n">coef_</span>
<span class="c1"># summarize feature importance
</span><span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">importance</span><span class="p">):</span>
	<span class="k">print</span><span class="p">(</span><span class="s">'Feature: %0d, Score: %.5f'</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">v</span><span class="p">))</span>
<span class="c1"># plot feature importance
</span><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">importance</span><span class="p">))],</span> <span class="n">importance</span><span class="p">,</span><span class="n">palette</span><span class="o">=</span><span class="s">"husl"</span><span class="p">)</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'cases_new'</span><span class="p">)</span>

<span class="c1">#set feature name
</span><span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">labels</span><span class="o">=</span><span class="n">feature_names</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Feature Importance of linear regression"</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Feature: 0, Score: 1073.27347
Feature: 1, Score: -98.14277
Feature: 2, Score: 1192.67976
Feature: 3, Score: 3814.90664
</code></pre></div></div>

<p><img src="https://raw.githubusercontent.com/ameerhaziq20/ameerhaziq20.github.io/main/_projects/Covid-19%20Malaysia%20Analysis%20And%20Prediction/output_118_2.png" alt="png" /></p>

<p><strong>Description:</strong> Here we can see the feature importance for the best model which is linear regression. The chart shows that the values of new death cases had the biggest impact in predicting the number of new cases followed by count rtk-ag tests, casual contacts and lastly pcr tests. The dataset had very small number of features so maybe we will include more features in the future.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#save and export model
</span><span class="n">best_model_save</span> <span class="o">=</span> <span class="s">'lin_model.sav'</span>
<span class="n">pickle</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">best_model_save</span><span class="p">,</span> <span class="s">'wb'</span><span class="p">))</span>
</code></pre></div></div>

</div>
  </main>
  <footer class="mt-auto py-3 text-center">

  <small class="text-muted mb-2">
    <i class="fas fa-code"></i> with <i class="fas fa-heart"></i>
    by <strong>Ameer Haziq Basharuddin</strong>
  </small>

  <div class="container-fluid justify-content-center"><a class="social mx-1"  href="mailto:ameerhaziq.work@gmail.com"
       style="color: #6c757d"
       onMouseOver="this.style.color='#db4437'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fas fa-envelope fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.github.com/ameerhaziq20"
       style="color: #6c757d"
       onMouseOver="this.style.color='#333333'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-github fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.instagram.com/emyrbreezy"
       style="color: #6c757d"
       onMouseOver="this.style.color='#405de6'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-instagram fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.linkedin.com/in/ameer-haziq-basharuddin-89593520a/"
       style="color: #6c757d"
       onMouseOver="this.style.color='#007bb5'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-linkedin-in fa-1x"></i>
    </a>

</div><!-- <small id="attribution">
    theme <a href="https://github.com/YoussefRaafatNasry/portfolYOU">portfolYOU</a>
  </small> -->
</footer>

  
  <!-- GitHub Buttons -->
<script async defer src="https://buttons.github.io/buttons.js"></script>

<!-- jQuery CDN -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Popper.js CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>

<!-- Bootstrap JS CDN -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<!-- wow.js CDN & Activation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.js"></script>
<script> new WOW().init(); </script>

<!-- Initialize all tooltips -->
<script>
$(function () {
    $('[data-toggle="tooltip"]').tooltip()
})
</script>
</body>

</html>